
\chapter{Contract Checks}

\minitoc

\section{Overview}

In file {\tt Checks.sol}

This contract is now used directly, but only inherited by other
contracts, such as {\tt BftgRoot}. However, the checks are not used.

\section{Variable Definitions}


\begin{lstlisting}[firstnumber=4]
    uint8 _checkList;
\end{lstlisting}

\section{Modifier Definitions}


\subsection{Modifier checksEmpty}

\begin{itemize}
\item Minor issue: a {\tt tvm.accept} should not be used without
  checking the origin of the message. Here, the checks are only done
  on the current initialization of the contract. In general, such a
  modifier could be used by an attacker to drain the balance of the
  contract. We advise to either remove the modifier, or remove the
  call to {\tt tvm.accept}.
\end{itemize}

\begin{lstlisting}[firstnumber=12]
    modifier checksEmpty() {
        require(_isCheckListEmpty(), 100); //Errors.NOT_ALL_CHECKS_PASSED);
        tvm.accept();
        _;
    }
\end{lstlisting}

\section{Internal Method Definitions}


\subsection{Function \_{}isCheckListEmpty}

\begin{itemize}
\item OK
\end{itemize}

\begin{lstlisting}[firstnumber=9]
    function _isCheckListEmpty() internal view inline returns (bool) {
        return (_checkList == 0);
    }
\end{lstlisting}

\subsection{Function \_{}passCheck}

\begin{itemize}
\item OK
\end{itemize}

\begin{lstlisting}[firstnumber=6]
    function _passCheck(uint8 check) internal inline {
        _checkList &= ~check;
    }
\end{lstlisting}
