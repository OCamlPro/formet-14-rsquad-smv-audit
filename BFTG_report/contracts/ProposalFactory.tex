
\chapter{Contract ProposalFactory}

\minitoc

\section{Overview}


In file {\tt ProposalFactory.sol}

\section{Contract Inheritance}


\noindent\begin{tabular}{|l|p{5cm}|}\hline
Base & \\\hline
\end{tabular}


\section{Static Variable Definitions}

\begin{itemize}
\item OK
\end{itemize}


\begin{lstlisting}[firstnumber=14]
    address static _deployer;
\end{lstlisting}

\section{Constructor Definitions}


\subsection{Constructor}

\begin{itemize}
\item OK
\end{itemize}

\begin{lstlisting}[firstnumber=16]
    constructor() public onlyContract {
        require(_deployer == msg.sender, Errors.ONLY_DEPLOYER);
    }
\end{lstlisting}

\section{Public Method Definitions}


\subsection{Function deployAddMemberProposal}

\begin{itemize}
\item OK
\end{itemize}

\begin{lstlisting}[firstnumber=75]
    function deployAddMemberProposal(
        address client,
        string title,
        uint128 votePrice,
        uint128 voteTotal,
        address voteProvider,
        address group,
        address[] whiteList,
        AddMemberProposalSpecific specific
    ) external view onlyContract {
        require(msg.value >= DEPLOY_PROPOSAL_PAY + 1 ton);
        TvmBuilder b;
        b.store(specific);
        TvmCell cellSpecific = b.toCell();
        ISmvRoot(_deployer).deployProposal
            {value: 0, flag: 64, bounce: true}
            (
                client,
                title,
                votePrice,
                voteTotal,
                voteProvider,
                group,
                whiteList,
                'add-member',
                cellSpecific
            );
    }
\end{lstlisting}

\subsection{Function deployContestProposal}

\begin{itemize}
\item OK
\end{itemize}

\begin{lstlisting}[firstnumber=20]
    function deployContestProposal(
        address client,
        string title,
        address group,
        ContestProposalSpecific specific
    ) external view onlyContract {
        require(msg.value >= DEPLOY_PROPOSAL_PAY + 1 ton);
        TvmBuilder b;
        b.store(specific);
        TvmCell cellSpecific = b.toCell();
        address[] arr;
        ISmvRoot(_deployer).deployProposal
            {value: 0, flag: 64, bounce: true}
            (
                client,
                title,
                1 ton,
                1000000000,
                address(0),
                group,
                arr,
                'contest',
                cellSpecific
            );
    }
\end{lstlisting}

\subsection{Function deployRemoveMemberProposal}

\begin{itemize}
\item OK
\end{itemize}

\begin{lstlisting}[firstnumber=46]
    function deployRemoveMemberProposal(
        address client,
        string title,
        uint128 votePrice,
        uint128 voteTotal,
        address voteProvider,
        address group,
        address[] whiteList,
        RemoveMemberProposalSpecific specific
    ) external view onlyContract {
        require(msg.value >= DEPLOY_PROPOSAL_PAY + 1 ton);
        TvmBuilder b;
        b.store(specific);
        TvmCell cellSpecific = b.toCell();
        ISmvRoot(_deployer).deployProposal
            {value: 0, flag: 64, bounce: true}
            (
                client,
                title,
                votePrice,
                voteTotal,
                voteProvider,
                group,
                whiteList,
                'remove-member',
                cellSpecific
            );
    }
\end{lstlisting}
